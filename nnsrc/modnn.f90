*******************************************************
*   Global Modules containing variables 
*   previously in common blocks
*******************************************************

      module legendre
        real*8, allocatable :: plp(:), plofx(:)
        real*8,allocatable :: pleg(:),pl(:,:)
      end module legendre

!*****************************************
      module trace
      integer :: am0,amtau,ampp,ampn,amon,tmat,dels,mon,moff,
     &            aeoff,aeon,xsec
      end module trace

!******************************************
      module jat
        complex*16 , allocatable :: a(:),b(:)
      end module jat
      
!******************************************
      module wk
      implicit complex*16 (a-h,o-z),integer*4(i-n)
c      real*8, allocatable :: vl(:,:)
      complex*16 ,allocatable:: ak(:,:),bk(:,:),cvl(:,:)
      end module wk

!******************************************
      module toff
       integer :: kmax,is,ll,jj,it,ic,klog,jmax,lmu
       real*8 :: p,redm
       real*8, allocatable :: vl(:,:)
       real*8, allocatable :: qq(:),wq(:)
      end module toff

!******************************************
      module kl
        logical:: vnn
       real*8, allocatable :: tkl(:),tvl(:)
      end module kl

!******************************************
      module jat1
       real*8, allocatable :: vl(:),xx(:),wx(:)
       complex*16, allocatable :: ttl(:,:)
      end module jat1

!***************************************************************
      module ampold
        complex*16, allocatable :: d01(:,:),dz1(:,:),dp1(:,:),
     $                       dm1(:,:),dpp1(:,:,:),dmm1(:,:,:)
       end module 

!****************************************************************
      module nnamp
      complex*16, allocatable ::aa(:,:,:),bb(:,:,:),
     $                     cc(:,:,:),dd(:,:,:),ee(:,:,:),ff(:,:,:)
      end module nnamp

!****************************************************************
      module ampnew
        complex*16, allocatable:: d0(:),dz(:),dp(:),
     $                           dm(:),dpp(:),dmm(:)
      end module ampnew

!****************************************************************
      module ampaux
        complex*16, allocatable :: ampl(:,:),ampw(:,:),ampz(:,:)
      end module ampaux

!****************************************************************
      module j
        implicit real*8(a-h,o-z)
        real*8, allocatable :: xkm(:,:),xkmp(:,:),pol(:),cs(:)
        real*8,allocatable,target:: xxq(:),xxk(:)
      end module j

!****************************************************************
      module jj2
        implicit real*8(a-h,o-z)
        real*8, allocatable :: xkm(:),xkmp(:)
        real*8,allocatable,target:: xxk(:),xxq(:)
      end module jj2

!****************************************************************
      module rc
        real*8, allocatable :: ctheta(:,:)
      end module rc
 
!****************************************************************
      module factorials
        real*8,allocatable,target:: fact(:),flog(:)
      end module factorials 

      module rc2
        real*8, allocatable :: ctheta(:)
      end module rc2

!****************************************************************     
      module block
        real*8, allocatable,target :: Bq(:),Sq(:)
      end module block

!****************************************************************
      module parms
        real*8 :: ttof,ch,pm,tm ,pi
      end module parms

!****************************************************************
!!$      module factrl
!!$        real*8,target :: f(52),faclog(500)
!!$      end module factrl

!****************************************************************
      module ampnl
!        integer :: ifkq,nth,itype,icase
        integer :: ifkq,nth,icase
        real*8 :: xkmax,xqmax,dk,dq,theta
      end module ampnl

!****************************************************************
!     Tensor amplitudes (on-shell)
      module tensamp
        complex*16 , allocatable :: mf(:,:,:,:,:,:)
      end module tensamp

c *** Amplitudes used by mso program
      module amps
        integer ::nthin !onshell angles in tensor rep.
        integer :: nkmx1,nqmx1
!           real*8,allocatable :: q(:),qq(:)
        real*8,pointer :: q(:),qq(:)
        complex*16,allocatable:: ap(:,:),cp(:,:)
        complex*16,allocatable:: app(:,:),apn(:,:)
        complex*16,allocatable:: cpp(:,:),cpn(:,:)
        complex*16,allocatable,target :: mfon(:,:,:,:,:,:)
      end module amps

!***************************************************************
      module ampon
        complex*16,allocatable:: aon(:),con(:)
      end module ampon

!***************************************************************
      module constants
        real*8:: hbarc,amu,finec,pi
      end module constants



!******************************************
c     Gauss point data for K matrix program
!******************************************
      module pw
        implicit double precision (a-h,o-z),integer*4(i-n)
        parameter (npwg=21)
        parameter (npwgl=7)
        real*8 :: pwg(npwg,npwg),pwgl(npwgl,npwgl)
      data (pwg(1,j),j=1,npwg)/
     $  .0000000e+00, .1761383e-01, .4060144e-01, .6267202e-01,
     $  .8327675e-01, .1019301e+00, .1181945e+00, .1316887e+00,
     $  .1420961e+00, .1491730e+00, .1527534e+00, .1527534e+00,
     $  .1491730e+00, .1420961e+00, .1316887e+00, .1181945e+00,
     $  .1019301e+00, .8327675e-01, .6267202e-01, .4060144e-01,
     $  .1761383e-01/
      data (pwg(2,j),j=1,npwg)/
     $  .0000000e+00, .0000000e+00, .1946174e-01, .4481420e-01,
     $  .6904453e-01, .9149003e-01, .1115667e+00, .1287540e+00,
     $  .1426067e+00, .1527661e+00, .1589689e+00, .1610544e+00,
     $  .1589689e+00, .1527661e+00, .1426067e+00, .1287540e+00,
     $  .1115667e+00, .9149003e-01, .6904453e-01, .4481420e-01,
     $  .1946174e-01/
      data (pwg(3,j),j=1,npwg)/
     $ -.5773503e+00, .5773503e+00, .0000000e+00, .2161604e-01,
     $  .4971453e-01, .7642573e-01, .1009421e+00, .1225552e+00,
     $  .1406429e+00, .1546847e+00, .1642765e+00, .1691424e+00,
     $  .1691424e+00, .1642765e+00, .1546847e+00, .1406429e+00,
     $  .1225552e+00, .1009421e+00, .7642573e-01, .4971453e-01,
     $  .2161604e-01/
      data (pwg(4,j),j=1,npwg)/
     $ -.7745967e+00, .0000000e+00, .7745967e+00, .0000000e+00,
     $  .2414834e-01, .5545948e-01, .8503616e-01, .1118838e+00,
     $  .1351364e+00, .1540458e+00, .1680041e+00, .1765627e+00,
     $  .1794465e+00, .1765627e+00, .1680041e+00, .1540458e+00,
     $  .1351364e+00, .1118838e+00, .8503616e-01, .5545948e-01,
     $  .2414834e-01/
      data (pwg(5,j),j=1,npwg)/
     $ -.8611363e+00,-.3399810e+00, .3399810e+00, .8611363e+00,
     $  .0000000e+00, .2715230e-01, .6225352e-01, .9515852e-01,
     $  .1246290e+00, .1495960e+00, .1691565e+00, .1826034e+00,
     $  .1894506e+00, .1894506e+00, .1826034e+00, .1691565e+00,
     $  .1495960e+00, .1246290e+00, .9515852e-01, .6225352e-01,
     $  .2715230e-01/
      data (pwg(6,j),j=1,npwg)/
     $ -.9061799e+00,-.5384693e+00, .0000000e+00, .5384693e+00,
     $  .9061799e+00, .0000000e+00, .3075310e-01, .7036602e-01,
     $  .1071592e+00, .1395707e+00, .1662692e+00, .1861610e+00,
     $  .1984315e+00, .2025782e+00, .1984315e+00, .1861610e+00,
     $  .1662692e+00, .1395707e+00, .1071592e+00, .7036602e-01,
     $  .3075310e-01/
      data (pwg(7,j),j=1,npwg)/
     $ -.9324695e+00,-.6612094e+00,-.2386192e+00, .2386192e+00,
     $  .6612094e+00, .9324695e+00, .0000000e+00, .3511935e-01,
     $  .8015805e-01, .1215186e+00, .1572032e+00, .1855384e+00,
     $  .2051985e+00, .2152639e+00, .2152639e+00, .2051985e+00,
     $  .1855384e+00, .1572032e+00, .1215186e+00, .8015805e-01,
     $  .3511935e-01/
      data (pwg(8,j),j=1,npwg)/
     $ -.9491079e+00,-.7415312e+00,-.4058452e+00, .0000000e+00,
     $  .4058452e+00, .7415312e+00, .9491079e+00, .0000000e+00,
     $  .4048391e-01, .9212154e-01, .1388735e+00, .1781460e+00,
     $  .2078161e+00, .2262832e+00, .2325516e+00, .2262832e+00,
     $  .2078161e+00, .1781460e+00, .1388735e+00, .9212154e-01,
     $  .4048391e-01/
      data (pwg(9,j),j=1,npwg)/
     $ -.9602899e+00,-.7966665e+00,-.5255324e+00,-.1834346e+00,
     $  .1834346e+00, .5255324e+00, .7966665e+00, .9602899e+00,
     $  .0000000e+00, .4717535e-01, .1069393e+00, .1600783e+00,
     $  .2031674e+00, .2334925e+00, .2491471e+00, .2491471e+00,
     $  .2334925e+00, .2031674e+00, .1600783e+00, .1069393e+00,
     $  .4717535e-01/
      data (pwg(10,j),j=1,npwg)/
     $ -.9602899e+00,-.7966665e+00,-.5255324e+00,-.1834346e+00,
     $  .0000000e+00, .3242534e+00, .6133714e+00, .8360311e+00,
     $  .9681602e+00, .0000000e+00, .5566857e-01, .1255804e+00,
     $  .1862902e+00, .2331938e+00, .2628046e+00, .2729251e+00,
     $  .2628046e+00, .2331938e+00, .1862902e+00, .1255804e+00,
     $  .5566857e-01/
      data (pwg(11,j),j=1,npwg)/
     $ -.9739065e+00,-.8650634e+00,-.6794096e+00,-.4333954e+00,
     $ -.1488743e+00, .1488743e+00, .4333954e+00, .6794096e+00,
     $  .8650634e+00, .9739065e+00, .0000000e+00, .6667125e-01,
     $  .1494514e+00, .2190864e+00, .2692667e+00, .2955242e+00,
     $  .2955242e+00, .2692667e+00, .2190864e+00, .1494514e+00,
     $  .6667125e-01/
      data (pwg(12,j),j=1,npwg)/
     $ -.9782287e+00,-.8870626e+00,-.7301520e+00,-.5190961e+00,
     $ -.2695432e+00, .0000000e+00, .2695432e+00, .5190961e+00,
     $  .7301520e+00, .8870626e+00, .9782287e+00, .0000000e+00,
     $  .8127433e-01, .1806482e+00, .2606107e+00, .3123471e+00,
     $  .3302394e+00, .3123471e+00, .2606107e+00, .1806482e+00,
     $  .8127433e-01/
      data (pwg(13,j),j=1,npwg)/
     $ -.9815606e+00,-.9041173e+00,-.7699027e+00,-.5873180e+00,
     $ -.3678315e+00,-.1252334e+00, .1252334e+00, .3678315e+00,
     $  .5873180e+00, .7699027e+00, .9041173e+00, .9815606e+00,
     $  .0000000e+00, .1012285e+00, .2223810e+00, .3137066e+00,
     $  .3626838e+00, .3626838e+00, .3137066e+00, .2223810e+00,
     $  .1012285e+00/
      data (pwg(14,j),j=1,npwg)/
     $ -.9841831e+00,-.9175984e+00,-.8015781e+00,-.6423493e+00,
     $ -.4484928e+00,-.2304583e+00, .0000000e+00, .2304583e+00,
     $  .4484928e+00, .6423493e+00, .8015781e+00, .9175984e+00,
     $  .9841831e+00, .0000000e+00, .1294849e+00, .2797054e+00,
     $  .3818301e+00, .4179592e+00, .3818301e+00, .2797054e+00,
     $  .1294849e+00/
      data (pwg(15,j),j=1,npwg)/
     $ -.9862838e+00,-.9284349e+00,-.8272013e+00,-.6872929e+00,
     $ -.5152486e+00,-.3191124e+00,-.1080550e+00, .1080550e+00,
     $  .3191124e+00, .5152486e+00, .6872929e+00, .8272013e+00,
     $  .9284349e+00, .9862838e+00, .0000000e+00, .1713245e+00,
     $  .3607616e+00, .4679139e+00, .4679139e+00, .3607616e+00,
     $  .1713245e+00/
      data (pwg(16,j),j=1,npwg)/
     $ -.9879925e+00,-.9372734e+00,-.8482066e+00,-.7244177e+00,
     $ -.5709722e+00,-.3941514e+00,-.2011941e+00, .0000000e+00,
     $  .2011941e+00, .3941514e+00, .5709722e+00, .7244177e+00,
     $  .8482066e+00, .9372734e+00, .9879925e+00, .0000000e+00,
     $  .2369269e+00, .4786287e+00, .5688889e+00, .4786287e+00,
     $  .2369269e+00/
      data (pwg(17,j),j=1,npwg)/
     $ -.9894010e+00,-.9445750e+00,-.8656312e+00,-.7554044e+00,
     $ -.6178763e+00,-.4580168e+00,-.2816036e+00,-.9501249e-01,
     $  .9501249e-01, .2816036e+00, .4580168e+00, .6178763e+00,
     $  .7554044e+00, .8656312e+00, .9445750e+00, .9894010e+00,
     $  .0000000e+00, .3478548e+00, .6521451e+00, .6521451e+00,
     $  .3478548e+00/
      data (pwg(18,j),j=1,npwg)/
     $ -.9905755e+00,-.9506755e+00,-.8802392e+00,-.7815140e+00,
     $ -.6576712e+00,-.5126905e+00,-.3512318e+00,-.1784842e+00,
     $  .0000000e+00, .1784842e+00, .3512318e+00, .5126905e+00,
     $  .6576712e+00, .7815140e+00, .8802392e+00, .9506755e+00,
     $  .9905755e+00, .0000000e+00, .5555555e+00, .8888889e+00,
     $  .5555555e+00/
      data (pwg(19,j),j=1,npwg)/
     $ -.9915652e+00,-.9558240e+00,-.8926025e+00,-.8037050e+00,
     $ -.6916871e+00,-.5597708e+00,-.4117512e+00,-.2518862e+00,
     $ -.8477503e-01, .8477503e-01, .2518862e+00, .4117512e+00,
     $  .5597708e+00, .6916871e+00, .8037050e+00, .8926025e+00,
     $  .9558240e+00, .9915652e+00, .0000000e+00, .1000000e+01,
     $  .1000000e+01/
      data (pwg(20,j),j=1,npwg)/
     $ -.9924069e+00,-.9602082e+00,-.9031559e+00,-.8227147e+00,
     $ -.7209662e+00,-.6005453e+00,-.4645707e+00,-.3165641e+00,
     $ -.1603586e+00, .0000000e+00, .1603586e+00, .3165641e+00,
     $  .4645707e+00, .6005453e+00, .7209662e+00, .8227147e+00,
     $  .9031559e+00, .9602082e+00, .9924069e+00, .0000000e+00,
     $  .2000000e+01/
      data (pwg(21,j),j=1,npwg)/
     $ -.9931286e+00,-.9639719e+00,-.9122344e+00,-.8391170e+00,
     $ -.7463319e+00,-.6360537e+00,-.5108670e+00,-.3737061e+00,
     $ -.2277859e+00,-.7652652e-01, .7652652e-01, .2277859e+00,
     $  .3737061e+00, .5108670e+00, .6360537e+00, .7463319e+00,
     $  .8391170e+00, .9122344e+00, .9639719e+00, .9931286e+00,
     $  .0000000e+00/
      data ((pwgl(i,j),j=1,npwgl),i=1,npwgl)/
     $  .0000000e+00, .7849016e+01, .4886827e+01, .3350525e+01,
     $  .2260685e+01, .1369253e+01, .5735355e+00, .1000000e+01,
     $  .0000000e+00, .7219186e+01, .4315657e+01, .2769443e+01,
     $  .1638488e+01, .6790940e+00, .5857864e+00, .3414214e+01,
     $  .0000000e+00, .6487145e+01, .3631146e+01, .2048102e+01,
     $  .8327391e+00, .4157746e+00, .2294280e+01, .6289945e+01,
     $  .0000000e+00, .5601095e+01, .2762143e+01, .1077693e+01,
     $  .3225477e+00, .1745761e+01, .4536620e+01, .9395071e+01,
     $  .0000000e+00, .4450957e+01, .1533326e+01, .2635603e+00,
     $  .1413403e+01, .3596426e+01, .7085810e+01, .1264080e+02,
     $  .0000000e+00, .2718282e+01, .2228466e+00, .1188932e+01,
     $  .2992736e+01, .5775144e+01, .9837467e+01, .1598287e+02,
     $  .0000000e+00/
c      end
      end module pw
